---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "buildkite_cluster_queue Resource - terraform-provider-buildkite"
subcategory: ""
description: |-
  A Cluster Queue is a queue belonging to a specific Cluster for its Agents to target builds on.
---

# buildkite_cluster_queue (Resource)

A Cluster Queue is a queue belonging to a specific Cluster for its Agents to target builds on.

## Example Usage

```terraform
# create a cluster
resource "buildkite_cluster" "primary" {
  name        = "Primary cluster"
  description = "Runs the monolith build and deploy"
  emoji       = "ðŸš€"
  color       = "#bada55"
}

resource "buildkite_pipeline" "monolith" {
  name       = "Monolith"
  repository = "https://github.com/..."
  cluster_id = buildkite_cluster.primary.id
}

# create a queue to put pipeline builds in
resource "buildkite_cluster_queue" "default" {
  cluster_id = buildkite_cluster.primary.id
  key        = "default"
  # Pause dispatch after create
  dispatch_paused = true
}

# create a hosted agent queue with macos agents
resource "buildkite_cluster_queue" "hosted_agents_macos" {
  cluster_id = buildkite_cluster.primary.id
  key        = "hosted-agents-macos"

  # Pause dispatch after create
  dispatch_paused = true

  hosted_agents = {
    instance_shape = "MACOS_M2_4X7"
  }
}

# create a hosted agent queue with linux agents
resource "buildkite_cluster_queue" "hosted_agents_linux" {
  cluster_id = buildkite_cluster.primary.id
  key        = "hosted-agents-linux"

  # Pause dispatch after create
  dispatch_paused = true

  hosted_agents = {
    instance_shape = "LINUX_AMD64_2X4"

    linux = {
      agent_image_ref = "ubuntu:24.04"
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cluster_id` (String) The ID of the cluster that this cluster queue belongs to.
- `key` (String) The key of the cluster queue.

### Optional

- `description` (String) A description for the cluster queue.
- `dispatch_paused` (Boolean) The dispatch state of a cluster queue.
- `hosted_agents` (Attributes) Control the settings for the Buildkite hosted agents. (see [below for nested schema](#nestedatt--hosted_agents))

### Read-Only

- `cluster_uuid` (String) The UUID of the cluster this queue belongs to.
- `id` (String) The GraphQL ID of the cluster queue.
- `uuid` (String) The UUID of the cluster queue.

<a id="nestedatt--hosted_agents"></a>
### Nested Schema for `hosted_agents`

Required:

- `instance_shape` (String) The instance shape to use for the Hosted Agent cluster queue. This can be a MacOS instance shape or a Linux instance shape.
Valid values are:
- MACOS_M2_4X7
- MACOS_M2_6X14
- MACOS_M2_12X28
- MACOS_M4_12X56
- MACOS_ARM64_M4_6X28
- MACOS_ARM64_M4_12X56
- LINUX_AMD64_2X4
- LINUX_AMD64_4X16
- LINUX_AMD64_8X32
- LINUX_AMD64_16X64
- LINUX_ARM64_2X4
- LINUX_ARM64_4X16
- LINUX_ARM64_8X32
- LINUX_ARM64_16X64

MacOS M4-based shapes (MACOS_ARM64_M4_6X28 and MACOS_ARM64_M4_12X56) supersede the legacy M2-based shapes (MACOS_M2_4X7, MACOS_M2_6X14, MACOS_M2_12X28, MACOS_M4_12X56), which will be deprecated on **July 31 2025**. We advise to update any existing queues to use the new M4 shapes ahead of time to avoid disruption. The legacy M2-based shapes options will be removed in future versions of this Provider. Check the [Buildkite CHANGELOG](https://buildkite.com/resources/changelog/293-mac-hosted-agents-now-running-on-m4-pro-hardware/) for more details.

Optional:

- `linux` (Attributes) (see [below for nested schema](#nestedatt--hosted_agents--linux))
- `mac` (Attributes) (see [below for nested schema](#nestedatt--hosted_agents--mac))

<a id="nestedatt--hosted_agents--linux"></a>
### Nested Schema for `hosted_agents.linux`

Required:

- `agent_image_ref` (String) A URL reference to a container image that will be used for jobs running within the queue. This URL is required to be publicly available, or pushed to the internal registry available within the cluster. Please note that this value is currently experimental and in preview. Please contact support@buildkite.com to enable this functionality for your organization.


<a id="nestedatt--hosted_agents--mac"></a>
### Nested Schema for `hosted_agents.mac`

Required:

- `xcode_version` (String) Optional selection of a specific XCode version to be selected for jobs in the queue to have available. Please note that this value is currently experimental and may not function as expected.

## Import

Using `terraform import`, import resources using the `id`. For example:
```shell
# import a cluster queue resource using the GraphQL ID along with its respective cluster UUID
#
# you can use this query to find the ID:
# query getClusterQueues {
#   organization(slug: "ORGANIZATION_SLUG") {
#     cluster(id: "CLUSTER_UUID") {
#       queues(first: 50) {
#         edges {
#           node {
#             id
#             key
#           }
#         }
#       }
#     }
#   }
# }
terraform import buildkite_cluster_queue.test Q2x1c3RlclF1ZXVlLS0tYjJiOGRhNTEtOWY5My00Y2MyLTkyMjktMGRiNzg3ZDQzOTAz,35498aaf-ad05-4fa5-9a07-91bf6cacd2bd
```

In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import instances using the `id`. For example:
```terraform
import {
  to = buildkite_cluster_queue.test
  id = "Q2x1c3RlclF1ZXVlLS0tYjJiOGRhNTEtOWY5My00Y2MyLTkyMjktMGRiNzg3ZDQzOTAz,35498aaf-ad05-4fa5-9a07-91bf6cacd2bd"
}
```
